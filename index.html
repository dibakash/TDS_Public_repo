<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>My TDS Graded Assignments Public folder</title>
        <style>
            *,
            ::after,
            ::before {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                display: grid;
                min-height: 100vh;
                place-items: center;
                place-content: center;
                text-align: center;
                gap: 1em;
                background: linear-gradient(135deg, maroon 50%, chocolate 40%);
                color: bisque;
                filter: drop-shadow(1px 1px 2px black);
            }
        </style>
    </head>

    <body>
        <h1>This is a public Graded Assignment Submissions <br>for<br> IIT Madras BS Degree TDS 2</h1>
        <h2>This is <em>Dibakash Baruah</em></h2>
        <!--email_off-->22f1001491@ds.study.iitm.ac.in<!--/email_off-->

        <a href="GA_2_3/TDS-GA-2-ASSIGNMENT-3/">GA_2_3 Submission</a>
        <a href="GA_2_5">GA_2_5 Submission</a>

        <form action="/" method="post" id="apiFrom">
            <label for="user">user</label>
            <input type="text" name="user">
            <button type="submit">Get Data</button>
        </form>
    </body>

    <script>
        const URL = "http://127.0.0.1:5000/api/data"
        const form = document.querySelector("#apiForm")
        const responseDiv = document.querySelector("#response")

        form.addEventListener("submit", async (event) => {
            event.preventDefault(); // Prevent form from submitting traditionally

            const userInput = document.querySelector("#user").value;

            if (!userInput) {
                displayResponse("Please enter a user value");
                return;
            }

            try {
                const data = await fetchData(userInput);
                displayResponse(JSON.stringify(data, null, 2));
            } catch (error) {
                displayResponse(`Error: ${error.message}`);
            }
        })

        const fetchData = async (user) => {
            try {
                const response = await fetch(URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ user: user })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                return data;
            } catch (error) {
                throw new Error(`Failed to fetch data: ${error.message}`);
            }
        }

        const displayResponse = (message) => {
            responseDiv.innerHTML = `<pre>${message}</pre>`;
        }
    </script>

</html>